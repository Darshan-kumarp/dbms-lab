CREATE TABLE ACTOR (
ACT_ID INT PRIMARY KEY,
ACT_NAME VARCHAR(20) NOT NULL,
ACT_GENDER CHAR(1) NOT NULL);

CREATE TABLE DIRECTOR(
DIR_ID INT PRIMARY KEY,
DIR_NAME VARCHAR(20) NOT NULL,
DIR_PHONE INT NOT NULL);

CREATE TABLE MOVIES(
MOV_ID INT PRIMARY KEY,
MOV_TITLE VARCHAR(25) NOT NULL,
MOV_YEAR INT NOT NULL,
MOV_LANG VARCHAR(15) NOT NULL,
DIR_ID INT NOT NULL REFERENCES DIRECTOR(DIR_ID));

CREATE TABLE MOVIE_CAST(
ACT_ID INT NOT NULL REFERENCES ACTOR(ACT_ID),
MOV_ID INT NOT NULL REFERENCES MOVIES(MOV_ID),
ROLE VARCHAR(10) NOT NULL); 

CREATE TABLE RATING(
MOV_ID INT REFERENCES MOVIES(MOV_ID),
REV_STARS VARCHAR(25) NOT NULL);


INSERT INTO ACTOR VALUES(101,'RAHUL','M');
INSERT INTO ACTOR VALUES(102,'ANKITHA','F');
INSERT INTO ACTOR VALUES(103,'RADHIKA','F');
INSERT INTO ACTOR VALUES(104,'CHETHAN','M');
INSERT INTO ACTOR VALUES(105,'VIVAN','M');



INSERT INTO DIRECTOR VALUES(201,'ANUP',918181818);
INSERT INTO DIRECTOR VALUES(202,'HITCHCOCK',918181812);
INSERT INTO DIRECTOR VALUES(203,'SHASHANK',918181813);
INSERT INTO DIRECTOR VALUES(204,'STEVEN SPIELBERG',918181814);
INSERT INTO DIRECTOR VALUES(205,'ANAND',918181815);



INSERT INTO MOVIES VALUES(1001,'MANASU',2017,'KANNADA',201);
INSERT INTO MOVIES VALUES(1002,'AAKASHAM',2015,'TELUGU',204);
INSERT INTO MOVIES VALUES(1003,'KALIYONA',2008,'KANNADA',201);
INSERT INTO MOVIES VALUES(1004,'WAR HORSE',2011,'ENGLISH',202);
INSERT INTO MOVIES VALUES(1005,'HOME',2012,'ENGLISH',205);



INSERT INTO MOVIE_CAST VALUES(101,1002,'HERO');
INSERT INTO MOVIE_CAST VALUES(101,1001,'HERO');
INSERT INTO MOVIE_CAST VALUES(103,1003,'HEROINE');
INSERT INTO MOVIE_CAST VALUES(103,1002,'GUEST');
INSERT INTO MOVIE_CAST VALUES(104,1004,'HERO');


INSERT INTO RATING VALUES(1001,4);
INSERT INTO RATING VALUES(1002,2);
INSERT INTO RATING VALUES(1003,5);
INSERT INTO RATING VALUES(1004,4);
INSERT INTO RATING VALUES(1005,3);


QUERIES............................

1.

SELECT M.Mov_Title
FROM MOVIES M
NATURAL JOIN DIRECTOR D
WHERE D.Dir_Name = 'Hitchcock';
2.

select m.mov_title
    from movies m
    natural join movie_cast mc
     where act_id in (select act_id
     from movie_cast
     group by act_id
     having count(act_id)>1)
     group by mov_title
     having count(*) > 1;

3.
select distinct act_name
from (actor join movie_cast using(act_id)) join movies using(mov_id)
where mov_year not between 2000 and 2015;

4.

select mov_title , max(rev_stars)
from movies natural join rating
group by mov_title
order by mov_title;

5.

update rating
set rev_stars = 5
where mov_id in ( select mov_id 
                  from director natural join movies
                  where dir_name = 'STEVEN SPIELBERG');
order by mov_id;
select * from rating
order by mov_id;
